language: cpp
notifications:
  email:
    on_success: change
    on_failure: change
compiler:
  - gcc
  - clang
before_install:
  - sudo apt-get update -qq
  - sudo apt-get install -y -qq lcov curl valgrind
  - git submodule update --init --recursive
script:
  - export COVERALLS_SERVICE_NAME=travis-ci # COVERALLS_REPO_TOKEN added in env vars in travis
  - cmake -DCOVERALLS=ON -DCMAKE_BUILD_TYPE=Debug examples/dev_testing
  - cmake --build .
  - ./exe
  - valgrind --leak-check=full --track-origins=yes --error-exitcode=1 ./exe
  - cmake --build . --target coveralls
