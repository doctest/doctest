set(doctest_src_folder "${CMAKE_CURRENT_LIST_DIR}/../../doctest")

file(READ ${doctest_src_folder}/parts/doctest_fwd.h  fwd)
file(READ ${doctest_src_folder}/parts/doctest.cpp impl)

set(doctest_out_folder "${CMAKE_CURRENT_LIST_DIR}/../../single_include/doctest")

file(WRITE  ${doctest_out_folder}/doctest.h "// ======================================================================\n")
file(APPEND ${doctest_out_folder}/doctest.h "// == DO NOT MODIFY THIS FILE BY HAND - IT IS AUTO GENERATED BY CMAKE! ==\n")
file(APPEND ${doctest_out_folder}/doctest.h "// ======================================================================\n")
file(APPEND ${doctest_out_folder}/doctest.h "${fwd}\n")
file(APPEND ${doctest_out_folder}/doctest.h "#ifndef DOCTEST_SINGLE_HEADER\n")
file(APPEND ${doctest_out_folder}/doctest.h "#define DOCTEST_SINGLE_HEADER\n")
file(APPEND ${doctest_out_folder}/doctest.h "#endif // DOCTEST_SINGLE_HEADER\n")
file(APPEND ${doctest_out_folder}/doctest.h "\n${impl}")
